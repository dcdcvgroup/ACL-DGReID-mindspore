# 1.This file shows the parsed IR info when graph evaluating failed to help find the problem.
# 2.You can search the last `------------------------>` to the node which is inferred failed.
# 3.Refer to https://www.mindspore.cn/search?inputValue=analyze_fail.ir to get more instructions.
# ===============================================================================

subgraph attr:
training : 0
subgraph instance: construct.Default.21 : 0x564d990167c0
# In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:434/    def construct(self, x, epoch, opt=None):/
subgraph @construct.Default.21(%para1_x, %para2_epoch, %para3_NL_1_idx, %para4_router1.fc_classifier.weight, %para5_conv1.weight, %para6_router1.fc2.weight, %para7_meta_fuse1.gate, %para8_router1.fc1.weight, %para9_router2.fc_classifier.weight, %para10_router2.fc2.weight, %para11_meta_se1.fc2.weight, %para12_meta_fuse2.gate, %para13_router2.fc1.weight, %para14_bn1.gamma, %para15_bn1.beta, %para16_router3.fc_classifier.weight, %para17_meta_se1.fc1.weight, %para18_bn1.moving_mean, %para19_bn1.moving_variance, %para20_adaptor1_base.conv3.weight, %para21_meta_fuse3.gate, %para22_router3.fc2.weight, %para23_router4.fc_classifier.weight, %para24_meta_fuse4.gate, %para25_adaptor1_base.conv2.weight, %para26_meta_se2.fc2.weight, %para27_router3.fc1.weight, %para28_invariant_norm1.gamma, %para29_invariant_norm1.beta, %para30_specific_norm1.gamma, %para31_specific_norm1.beta, %para32_adaptor1_sub.conv3.weight, %para33_meta_se2.fc1.weight, %para34_adaptor1_base.conv1.weight, %para35_router4.fc2.weight, %para36_invariant_norm1.moving_mean, %para37_invariant_norm1.moving_variance, %para38_specific_norm1.moving_mean, %para39_specific_norm1.moving_variance, %para40_adaptor2_sub.conv3.weight, %para41_adaptor3_sub.conv3.weight, %para42_adaptor4_sub.conv3.weight, %para43_adaptor2_base.conv3.weight, %para44_adaptor1_sub.conv2.weight, %para45_adaptor3_base.conv3.weight, %para46_meta_se3.fc2.weight, %para47_adaptor4_base.conv3.weight, %para48_router4.fc1.weight, %para49_meta_se4.fc2.weight, %para50_adaptor2_sub.conv2.weight, %para51_adaptor3_sub.conv2.weight, %para52_meta_se3.fc1.weight, %para53_adaptor4_sub.conv2.weight, %para54_adaptor2_base.conv2.weight, %para55_adaptor1_sub.conv1.weight, %para56_adaptor3_base.conv2.weight, %para57_adaptor4_base.conv2.weight, %para58_meta_se4.fc1.weight, %para59_invariant_norm2.gamma, %para60_invariant_norm2.beta, %para61_specific_norm2.gamma, %para62_specific_norm2.beta, %para63_adaptor2_sub.conv1.weight, %para64_adaptor3_sub.conv1.weight, %para65_adaptor4_sub.conv1.weight, %para66_adaptor2_base.conv1.weight, %para67_adaptor3_base.conv1.weight, %para68_adaptor4_base.conv1.weight, %para69_invariant_norm2.moving_mean, %para70_invariant_norm2.moving_variance, %para71_specific_norm2.moving_mean, %para72_specific_norm2.moving_variance, %para73_adaptor1_base.bn3.gamma, %para74_adaptor1_base.bn3.beta, %para75_invariant_norm3.gamma, %para76_invariant_norm3.beta, %para77_specific_norm3.gamma, %para78_specific_norm3.beta, %para79_invariant_norm4.gamma, %para80_invariant_norm4.beta, %para81_specific_norm4.gamma, %para82_specific_norm4.beta, %para83_adaptor1_base.bn2.gamma, %para84_adaptor1_base.bn2.beta, %para85_invariant_norm3.moving_mean, %para86_invariant_norm3.moving_variance, %para87_specific_norm3.moving_mean, %para88_specific_norm3.moving_variance, %para89_map4.gamma, %para90_map4.beta, %para91_adaptor1_sub.bn3.gamma, %para92_adaptor1_sub.bn3.beta, %para93_invariant_norm4.moving_mean, %para94_invariant_norm4.moving_variance, %para95_specific_norm4.moving_mean, %para96_specific_norm4.moving_variance, %para97_map3.gamma, %para98_map3.beta, %para99_map4.moving_mean, %para100_map4.moving_variance, %para101_adaptor1_base.bn1.gamma, %para102_adaptor1_base.bn1.beta, %para103_adaptor1_sub.bn3.moving_mean, %para104_adaptor1_sub.bn3.moving_variance, %para105_adaptor2_sub.bn3.gamma, %para106_adaptor2_sub.bn3.beta, %para107_adaptor3_sub.bn3.gamma, %para108_adaptor3_sub.bn3.beta, %para109_adaptor4_sub.bn3.gamma, %para110_adaptor4_sub.bn3.beta, %para111_adaptor1_sub.bn2.gamma, %para112_adaptor1_sub.bn2.beta, %para113_map2.gamma, %para114_map2.beta, %para115_map3.moving_mean, %para116_map3.moving_variance, %para117_adaptor2_base.bn3.gamma, %para118_adaptor2_base.bn3.beta, %para119_adaptor2_sub.bn3.moving_mean, %para120_adaptor2_sub.bn3.moving_variance, %para121_adaptor3_sub.bn3.moving_mean, %para122_adaptor3_sub.bn3.moving_variance, %para123_adaptor3_base.bn3.gamma, %para124_adaptor3_base.bn3.beta, %para125_adaptor4_sub.bn3.moving_mean, %para126_adaptor4_sub.bn3.moving_variance, %para127_adaptor4_base.bn3.gamma, %para128_adaptor4_base.bn3.beta, %para129_adaptor1_sub.bn2.moving_mean, %para130_adaptor1_sub.bn2.moving_variance, %para131_adaptor2_sub.bn2.gamma, %para132_adaptor2_sub.bn2.beta, %para133_adaptor3_sub.bn2.gamma, %para134_adaptor3_sub.bn2.beta, %para135_adaptor4_sub.bn2.gamma, %para136_adaptor4_sub.bn2.beta, %para137_map1.gamma, %para138_map1.beta, %para139_map2.moving_mean, %para140_map2.moving_variance, %para141_adaptor2_base.bn2.gamma, %para142_adaptor2_base.bn2.beta, %para143_adaptor2_sub.bn2.moving_mean, %para144_adaptor2_sub.bn2.moving_variance, %para145_adaptor3_sub.bn2.moving_mean, %para146_adaptor3_sub.bn2.moving_variance, %para147_adaptor3_base.bn2.gamma, %para148_adaptor3_base.bn2.beta, %para149_adaptor4_sub.bn2.moving_mean, %para150_adaptor4_sub.bn2.moving_variance, %para151_adaptor4_base.bn2.gamma, %para152_adaptor4_base.bn2.beta, %para153_map1.moving_mean, %para154_map1.moving_variance, %para155_adaptor2_base.bn1.gamma, %para156_adaptor2_base.bn1.beta, %para157_adaptor3_base.bn1.gamma, %para158_adaptor3_base.bn1.beta, %para159_adaptor4_base.bn1.gamma, %para160_adaptor4_base.bn1.beta, %para161_adaptor1_sub.bn1.BN.gamma, %para162_adaptor1_sub.bn1.BN.beta, %para163_adaptor1_sub.bn1.IN.gamma, %para164_adaptor1_sub.bn1.IN.beta, %para165_adaptor1_sub.bn1.BN.moving_mean, %para166_adaptor1_sub.bn1.BN.moving_variance, %para167_adaptor2_sub.bn1.BN.gamma, %para168_adaptor2_sub.bn1.BN.beta, %para169_adaptor3_sub.bn1.BN.gamma, %para170_adaptor3_sub.bn1.BN.beta, %para171_adaptor4_sub.bn1.BN.gamma, %para172_adaptor4_sub.bn1.BN.beta, %para173_adaptor2_sub.bn1.IN.gamma, %para174_adaptor2_sub.bn1.IN.beta, %para175_adaptor3_sub.bn1.IN.gamma, %para176_adaptor3_sub.bn1.IN.beta, %para177_adaptor4_sub.bn1.IN.gamma, %para178_adaptor4_sub.bn1.IN.beta, %para179_adaptor2_sub.bn1.BN.moving_mean, %para180_adaptor2_sub.bn1.BN.moving_variance, %para181_adaptor3_sub.bn1.BN.moving_mean, %para182_adaptor3_sub.bn1.BN.moving_variance, %para183_adaptor4_sub.bn1.BN.moving_mean, %para184_adaptor4_sub.bn1.BN.moving_variance) {
  %1([CNode]33) = call @print_.32(I64(4))
      : (<Int64, NoShape>) -> (<Tensor[Int32], (1)>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:438/        print(4)/
  %2([CNode]34) = StopGradient(%1)
      : (<Tensor[Int32], (1)>) -> (<Tensor[Int32], (1)>)
      #scope: (Default)
  %3([CNode]36) = call @ms_len.35(%para3_NL_1_idx)
      : (<Ref[Tensor[Int64]], (1)>) -> (<Int64, NoShape>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
  %4([CNode]37) = S-Prim-equal(%3, I64(0))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
  %5([CNode]39) = call @bool_.38(%4)
      : (<Bool, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
  %6([CNode]40) = Switch(%5, call @✓construct.Default.41, call @✗construct.Default.22)
      : (<Bool, NoShape>, <Func, NoShape>, <Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/

#------------------------> 0
  %7([CNode]42) = %6()
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
  %8([CNode]43) = Depend[side_effect_propagate=I64(1)](%7, %2)
      : (<null>, <Tensor[Int32], (1)>) -> (<null>)
      #scope: (Default)
  Return(%8)
      : (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
}
# Order:
#   1: @construct.Default.21:[CNode]33{[0]: ValueNode<FuncGraph> print_.32, [1]: ValueNode<Int64Imm> 4}
#   2: @construct.Default.21:x{[0]: ValueNode<FuncGraph> construct.MetaConv2d.44, [1]: x, [2]: ValueNode<None> None}
#   3: @construct.Default.21:x{[0]: ValueNode<FuncGraph> construct.MetaBNNorm.45, [1]: x, [2]: ValueNode<None> None}
#   4: @construct.Default.21:x{[0]: ValueNode<FuncGraph> construct.ReLU.46, [1]: x}
#   5: @construct.Default.21:фx{[0]: ValueNode<FuncGraph> construct.MaxPool2d.47, [1]: x}
#   6: @construct.Default.21:[CNode]36{[0]: ValueNode<FuncGraph> ms_len.35, [1]: NL_1_idx}
#   7: @construct.Default.21:[CNode]37{[0]: ValueNode<DoSignaturePrimitive> S-Prim-equal, [1]: [CNode]36, [2]: ValueNode<Int64Imm> 0}
#   8: @construct.Default.21:[CNode]39{[0]: ValueNode<FuncGraph> bool_.38, [1]: [CNode]37}
#   9: @construct.Default.21:[CNode]40{[0]: ValueNode<Primitive> Switch, [1]: [CNode]39, [2]: ValueNode<FuncGraph> ✓construct.Default.41, [3]: ValueNode<FuncGraph> ✗construct.Default.22}
#  10: @construct.Default.21:[CNode]42{[0]: [CNode]40}
#  11: @construct.Default.21:[CNode]48{[0]: ValueNode<Primitive> Return, [1]: [CNode]43}


subgraph attr:
training : 0
subgraph instance: ✗construct.Default.22 : 0x564dbdcdaed0
# In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
subgraph @✗construct.Default.22 parent: [subgraph @construct.Default.21]() {

#------------------------> 1
  %1([CNode]49) = call @↓construct.Default.23()
      #scope: (Default)
  Return(%1)
      : (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
}
# Order:
#   1: @✗construct.Default.22:[CNode]50{[0]: ValueNode<Primitive> Return, [1]: [CNode]49}
#   2: @✗construct.Default.22:[CNode]49{[0]: ValueNode<FuncGraph> ↓construct.Default.23}


subgraph attr:
after_block : 1
training : 0
subgraph instance: ↓construct.Default.23 : 0x564db5506170
# In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:450/        if len(self.NL_1_idx) == 0:/
subgraph @↓construct.Default.23 parent: [subgraph @construct.Default.21]() {
  %1(x) = $(construct.Default.21):call @construct.MetaConv2d.44(%para1_x, None)
      : (<Tensor[Float32], (8, 3, 8, 8)>, <None, NoShape>) -> (<Tensor[Float32], (8, 64, 4, 4)>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:440/        x = self.conv1(x, opt)/
  %2(x) = $(construct.Default.21):call @construct.MetaBNNorm.45(%1, None)
      : (<Tensor[Float32], (8, 64, 4, 4)>, <None, NoShape>) -> (<Tensor[Float32], (8, 64, 4, 4)>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:441/        x = self.bn1(x, opt)/
  %3(x) = $(construct.Default.21):call @construct.ReLU.46(%2)
      : (<Tensor[Float32], (8, 64, 4, 4)>) -> (<Tensor[Float32], (8, 64, 4, 4)>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:442/        x = self.relu(x)/
  %4(фx) = $(construct.Default.21):call @construct.MaxPool2d.47(%3)
      : (<Tensor[Float32], (8, 64, 4, 4)>) -> (<Tensor[Float32], (8, 64, 2, 2)>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:460/        x_invariant = self.adaptor1_base(x, opt)/

#------------------------> 2
  %5([CNode]52) = call @construct.HyperRouter.51(%4, None)
      : (<Tensor[Float32], (8, 64, 2, 2)>, <None, NoShape>) -> (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:465/        weight, domain_cls_logit = self.router1(x, opt)/
  %6(domain_cls_logit) = S-Prim-getitem(%5, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:465/        weight, domain_cls_logit = self.router1(x, opt)/
  %7([CNode]53) = StopGradient(%6)
      : (<null>) -> (<null>)
      #scope: (Default)
  %8([CNode]54) = call @ms_len.35(%para3_NL_1_idx)
      : (<Ref[Tensor[Int64]], (1)>) -> (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:480/        if len(self.NL_2_idx) == 0:/
  %9([CNode]55) = S-Prim-equal(%8, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:480/        if len(self.NL_2_idx) == 0:/
  %10([CNode]56) = call @bool_.38(%9)
      : (<null>) -> (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:480/        if len(self.NL_2_idx) == 0:/
  %11([CNode]57) = Switch(%10, call @✓↓construct.Default.58, call @✗↓construct.Default.59)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:480/        if len(self.NL_2_idx) == 0:/
  %12([CNode]60) = %11()
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:480/        if len(self.NL_2_idx) == 0:/
  %13([CNode]61) = Depend[side_effect_propagate=I64(1)](%12, %7)
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
  Return(%13)
      : (<null>)
      #scope: (Default)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:480/        if len(self.NL_2_idx) == 0:/
}
# Order:
#   1: @↓construct.Default.23:x_invariant{[0]: ValueNode<FuncGraph> construct.Bottleneck.62, [1]: фx, [2]: ValueNode<None> None}
#   2: @↓construct.Default.23:[CNode]63{[0]: ValueNode<Primitive> getattr, [1]: x_invariant, [2]: ValueNode<StringImm> shape}
#   3: @↓construct.Default.23:N{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: [CNode]63, [2]: ValueNode<Int64Imm> 0}
#   4: @↓construct.Default.23:C{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: [CNode]63, [2]: ValueNode<Int64Imm> 1}
#   5: @↓construct.Default.23:H{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: [CNode]63, [2]: ValueNode<Int64Imm> 2}
#   6: @↓construct.Default.23:W{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: [CNode]63, [2]: ValueNode<Int64Imm> 3}
#   7: @↓construct.Default.23:[CNode]64{[0]: ValueNode<Primitive> getattr, [1]: фx, [2]: ValueNode<StringImm> tile}
#   8: @↓construct.Default.23:[CNode]65{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MakeTuple, [1]: ValueNode<Int64Imm> 1, [2]: ValueNode<Int64Imm> 4, [3]: ValueNode<Int64Imm> 1, [4]: ValueNode<Int64Imm> 1}
#   9: @↓construct.Default.23:[CNode]66{[0]: [CNode]64, [1]: [CNode]65}
#  10: @↓construct.Default.23:[CNode]67{[0]: ValueNode<FuncGraph> construct.Bottleneck2.68, [1]: [CNode]66, [2]: ValueNode<None> None}
#  11: @↓construct.Default.23:[CNode]69{[0]: ValueNode<Primitive> getattr, [1]: [CNode]67, [2]: ValueNode<StringImm> reshape}
#  12: @↓construct.Default.23:x_specific{[0]: [CNode]69, [1]: N, [2]: ValueNode<Int64Imm> 4, [3]: C, [4]: H, [5]: W}
#  13: @↓construct.Default.23:[CNode]52{[0]: ValueNode<FuncGraph> construct.HyperRouter.51, [1]: фx, [2]: ValueNode<None> None}
#  14: @↓construct.Default.23:weight{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: [CNode]52, [2]: ValueNode<Int64Imm> 0}
#  15: @↓construct.Default.23:domain_cls_logit{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: [CNode]52, [2]: ValueNode<Int64Imm> 1}
#  16: @↓construct.Default.23:[CNode]70{[0]: ValueNode<Primitive> getattr, [1]: ValueNode<ValueList> [], [2]: ValueNode<StringImm> append}
#  17: @↓construct.Default.23:фweights{[0]: [CNode]70, [1]: weight}
#  18: @↓construct.Default.23:[CNode]71{[0]: ValueNode<Primitive> getattr, [1]: weight, [2]: ValueNode<StringImm> reshape}
#  19: @↓construct.Default.23:[CNode]72{[0]: ValueNode<DoSignaturePrimitive> S-Prim-negative, [1]: ValueNode<Int64Imm> 1}
#  20: @↓construct.Default.23:[CNode]73{[0]: [CNode]71, [1]: [CNode]72, [2]: ValueNode<Int64Imm> 4, [3]: ValueNode<Int64Imm> 1, [4]: ValueNode<Int64Imm> 1, [5]: ValueNode<Int64Imm> 1}
#  21: @↓construct.Default.23:[CNode]74{[0]: ValueNode<DoSignaturePrimitive> S-Prim-mul, [1]: x_specific, [2]: [CNode]73}
#  22: @↓construct.Default.23:[CNode]75{[0]: ValueNode<Primitive> getattr, [1]: [CNode]74, [2]: ValueNode<StringImm> sum}
#  23: @↓construct.Default.23:x_specific{[0]: [CNode]75, [1]: ValueNode<Int64Imm> 1}
#  24: @↓construct.Default.23:x_invariant{[0]: ValueNode<FuncGraph> construct.MetaBNNorm.76, [1]: x_invariant, [2]: ValueNode<None> None}
#  25: @↓construct.Default.23:x_specific{[0]: ValueNode<FuncGraph> construct.MetaBNNorm.77, [1]: x_specific, [2]: ValueNode<None> None}
#  26: @↓construct.Default.23:x{[0]: ValueNode<FuncGraph> construct.MetaGate.78, [1]: x_invariant, [2]: x_specific, [3]: ValueNode<None> None}
#  27: @↓construct.Default.23:фx{[0]: ValueNode<FuncGraph> construct.MetaSELayer.79, [1]: x, [2]: ValueNode<None> None}
#  28: @↓construct.Default.23:[CNode]80{[0]: ValueNode<FuncGraph> construct.AdaptiveAvgPool2d.81, [1]: фx}
#  29: @↓construct.Default.23:temp{[0]: ValueNode<FuncGraph> construct.MetaBNNorm.82, [1]: [CNode]80, [2]: ValueNode<None> None}
#  30: @↓construct.Default.23:[CNode]83{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MakeTuple, [1]: ValueNode<StringImm> axis}
#  31: @↓construct.Default.23:[CNode]84{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MakeTuple, [1]: ValueNode<Int64Imm> 1}
#  32: @↓construct.Default.23:[CNode]85{[0]: ValueNode<DoSignaturePrimitive> S-Prim-make_dict, [1]: [CNode]83, [2]: [CNode]84}
#  33: @↓construct.Default.23:l2_normalize{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.86, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.nn_ops.L2Normalize', [2]: [CNode]85}
#  34: @↓construct.Default.23:x_normalized{[0]: l2_normalize, [1]: temp}
#  35: @↓construct.Default.23:[CNode]87{[0]: ValueNode<Primitive> getattr, [1]: ValueNode<ValueList> [], [2]: ValueNode<StringImm> append}
#  36: @↓construct.Default.23:[CNode]88{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MakeTuple, [1]: ValueNode<Ellipsis> Ellipsis, [2]: ValueNode<Int64Imm> 0, [3]: ValueNode<Int64Imm> 0}
#  37: @↓construct.Default.23:[CNode]89{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: x_normalized, [2]: [CNode]88}
#  38: @↓construct.Default.23:фout_features{[0]: [CNode]87, [1]: [CNode]89}
#  39: @↓construct.Default.23:[CNode]54{[0]: ValueNode<FuncGraph> ms_len.35, [1]: NL_1_idx}
#  40: @↓construct.Default.23:[CNode]55{[0]: ValueNode<DoSignaturePrimitive> S-Prim-equal, [1]: [CNode]54, [2]: ValueNode<Int64Imm> 0}
#  41: @↓construct.Default.23:[CNode]56{[0]: ValueNode<FuncGraph> bool_.38, [1]: [CNode]55}
#  42: @↓construct.Default.23:[CNode]57{[0]: ValueNode<Primitive> Switch, [1]: [CNode]56, [2]: ValueNode<FuncGraph> ✓↓construct.Default.58, [3]: ValueNode<FuncGraph> ✗↓construct.Default.59}
#  43: @↓construct.Default.23:[CNode]60{[0]: [CNode]57}
#  44: @↓construct.Default.23:[CNode]90{[0]: ValueNode<Primitive> Return, [1]: [CNode]61}


subgraph attr:
training : 0
subgraph instance: construct.HyperRouter.24 : 0x564d9bf36080
# In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:289/    def construct(self, x, opt=None):/
subgraph @construct.HyperRouter.24 parent: [subgraph @construct.Default.21](%para185_x, %para186_opt) {
  %1([CNode]91) = getattr(%para185_x, "shape")
      : (<Tensor[Float32], (8, 64, 2, 2)>, <String, NoShape>) -> (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %2([CNode]93) = call @ms_len.92(%1)
      : (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>) -> (<Int64, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %3([CNode]94) = S-Prim-make_range(%2)
      : (<Int64, NoShape>) -> (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %4([CNode]95) = ClassType(%3)
      : (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>) -> (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %5([CNode]96) = S-Prim-negative(I64(2))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %6([CNode]97) = S-Prim-make_slice(%5, None, None)
      : (<Int64, NoShape>, <None, NoShape>, <None, NoShape>) -> (<Slice[Int64 : None : None], NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %7([CNode]98) = S-Prim-getitem(%4, %6)
      : (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>, <Slice[Int64 : None : None], NoShape>) -> (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %8([CNode]99) = S-Prim-ReduceMean[output_names=["y"], keep_dims=Bool(1), input_names=["input_x", "axis"]](%para185_x, %7)
      : (<Tensor[Float32], (8, 64, 2, 2)>, <Tuple[Int64*2], TupleShape(NoShape, NoShape)>) -> (<Tensor[Float32], (8, 64, 1, 1)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %9([CNode]100) = getattr(%8, "squeeze")
      : (<Tensor[Float32], (8, 64, 1, 1)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %10([CNode]101) = S-Prim-negative(I64(1))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %11([CNode]102) = %9(%10)
      : (<Int64, NoShape>) -> (<Tensor[Float32], (8, 64, 1)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %12([CNode]103) = getattr(%11, "squeeze")
      : (<Tensor[Float32], (8, 64, 1)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %13([CNode]104) = S-Prim-negative(I64(1))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %14(x) = %12(%13)
      : (<Int64, NoShape>) -> (<Tensor[Float32], (8, 64)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:291/        x = self.avgpool(x, tuple(range(len(x.shape)))[-2:]).squeeze(-1).squeeze(-1)/
  %15([CNode]105) = S-Prim-MakeTuple("axis")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:293/        l2_normalize = ops.L2Normalize(axis=-1)/
  %16([CNode]106) = S-Prim-negative(I64(1))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:293/        l2_normalize = ops.L2Normalize(axis=-1)/
  %17([CNode]107) = S-Prim-MakeTuple(%16)
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:293/        l2_normalize = ops.L2Normalize(axis=-1)/
  %18([CNode]108) = S-Prim-make_dict(%15, %17)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[axis,],[Int64]], NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:293/        l2_normalize = ops.L2Normalize(axis=-1)/
  %19(l2_normalize) = UnpackCall-unpack_call(ClassType, %18)
      : (<Func, NoShape>, <Dictionary[[axis,],[Int64]], NoShape>) -> (<Func, NoShape>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:293/        l2_normalize = ops.L2Normalize(axis=-1)/

#------------------------> 3
  %20([CNode]110) = call @construct.MetaLinear.109(%14, %para186_opt)
      : (<Tensor[Float32], (8, 64)>, <None, NoShape>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:294/        x_normalized = l2_normalize(self.fc1(x, opt))/
  %21(x_normalized) = %19(%20)
      : (<null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:294/        x_normalized = l2_normalize(self.fc1(x, opt))/
  %22(weight) = call @construct.ReLU.111(%21)
      : (<null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:297/        weight = self.relu(x_normalized)/
  %23([CNode]113) = call @construct.MetaLinear.112(%22, %para186_opt)
      : (<null>, <None, NoShape>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:299/        weight = self.fc2(weight, opt).reshape(-1, self.planes, K)/
  %24([CNode]114) = getattr(%23, "reshape")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:299/        weight = self.fc2(weight, opt).reshape(-1, self.planes, K)/
  %25([CNode]115) = S-Prim-negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:299/        weight = self.fc2(weight, opt).reshape(-1, self.planes, K)/
  %26(weight) = %24(%25, I64(256), I64(4))
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:299/        weight = self.fc2(weight, opt).reshape(-1, self.planes, K)/
  %27([CNode]117) = call @einsum.116("bi,bil->bl", %14, %26)
      : (<null>, <Tensor[Float32], (8, 64)>, <null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:302/        x = self.softmax(ops.einsum('bi,bil->bl', x, weight))/
  %28(x) = call @construct.Softmax.118(%27)
      : (<null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:302/        x = self.softmax(ops.einsum('bi,bil->bl', x, weight))/
  %29([CNode]119) = getattr(%26, "reshape")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:301/        domain_cls_logits = self.fc_classifier(weight.reshape(-1, self.planes*K), opt)/
  %30([CNode]120) = S-Prim-negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:301/        domain_cls_logits = self.fc_classifier(weight.reshape(-1, self.planes*K), opt)/
  %31([CNode]121) = S-Prim-mul(I64(256), I64(4))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:301/        domain_cls_logits = self.fc_classifier(weight.reshape(-1, self.planes*K), opt)/
  %32([CNode]122) = %29(%30, %31)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:301/        domain_cls_logits = self.fc_classifier(weight.reshape(-1, self.planes*K), opt)/
  %33(domain_cls_logits) = call @construct.MetaLinear.123(%32, %para186_opt)
      : (<null>, <None, NoShape>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:301/        domain_cls_logits = self.fc_classifier(weight.reshape(-1, self.planes*K), opt)/
  %34([CNode]124) = S-Prim-MakeTuple(%28, %33)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:306/        return x, domain_cls_logits/
  Return(%34)
      : (<null>)
      #scope: (Default/router1-HyperRouter)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/backbones/meta_dynamic_router_resnet.py:306/        return x, domain_cls_logits/
}
# Order:
#   1: @construct.HyperRouter.24:[CNode]91{[0]: ValueNode<Primitive> getattr, [1]: x, [2]: ValueNode<StringImm> shape}
#   2: @construct.HyperRouter.24:[CNode]93{[0]: ValueNode<FuncGraph> ms_len.92, [1]: [CNode]91}
#   3: @construct.HyperRouter.24:[CNode]94{[0]: ValueNode<DoSignaturePrimitive> S-Prim-make_range, [1]: [CNode]93}
#   4: @construct.HyperRouter.24:[CNode]96{[0]: ValueNode<DoSignaturePrimitive> S-Prim-negative, [1]: ValueNode<Int64Imm> 2}
#   5: @construct.HyperRouter.24:[CNode]97{[0]: ValueNode<DoSignaturePrimitive> S-Prim-make_slice, [1]: [CNode]96, [2]: ValueNode<None> None, [3]: ValueNode<None> None}
#   6: @construct.HyperRouter.24:[CNode]98{[0]: ValueNode<DoSignaturePrimitive> S-Prim-getitem, [1]: [CNode]95, [2]: [CNode]97}
#   7: @construct.HyperRouter.24:[CNode]99{[0]: ValueNode<DoSignaturePrimitive> S-Prim-ReduceMean, [1]: x, [2]: [CNode]98}
#   8: @construct.HyperRouter.24:[CNode]100{[0]: ValueNode<Primitive> getattr, [1]: [CNode]99, [2]: ValueNode<StringImm> squeeze}
#   9: @construct.HyperRouter.24:[CNode]101{[0]: ValueNode<DoSignaturePrimitive> S-Prim-negative, [1]: ValueNode<Int64Imm> 1}
#  10: @construct.HyperRouter.24:[CNode]102{[0]: [CNode]100, [1]: [CNode]101}
#  11: @construct.HyperRouter.24:[CNode]103{[0]: ValueNode<Primitive> getattr, [1]: [CNode]102, [2]: ValueNode<StringImm> squeeze}
#  12: @construct.HyperRouter.24:[CNode]104{[0]: ValueNode<DoSignaturePrimitive> S-Prim-negative, [1]: ValueNode<Int64Imm> 1}
#  13: @construct.HyperRouter.24:x{[0]: [CNode]103, [1]: [CNode]104}
#  14: @construct.HyperRouter.24:[CNode]106{[0]: ValueNode<DoSignaturePrimitive> S-Prim-negative, [1]: ValueNode<Int64Imm> 1}
#  15: @construct.HyperRouter.24:[CNode]105{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MakeTuple, [1]: ValueNode<StringImm> axis}
#  16: @construct.HyperRouter.24:[CNode]107{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MakeTuple, [1]: [CNode]106}
#  17: @construct.HyperRouter.24:[CNode]108{[0]: ValueNode<DoSignaturePrimitive> S-Prim-make_dict, [1]: [CNode]105, [2]: [CNode]107}
#  18: @construct.HyperRouter.24:l2_normalize{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.125, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.nn_ops.L2Normalize', [2]: [CNode]108}
#  19: @construct.HyperRouter.24:[CNode]110{[0]: ValueNode<FuncGraph> construct.MetaLinear.109, [1]: x, [2]: opt}
#  20: @construct.HyperRouter.24:x_normalized{[0]: l2_normalize, [1]: [CNode]110}
#  21: @construct.HyperRouter.24:weight{[0]: ValueNode<FuncGraph> construct.ReLU.111, [1]: x_normalized}
#  22: @construct.HyperRouter.24:[CNode]113{[0]: ValueNode<FuncGraph> construct.MetaLinear.112, [1]: weight, [2]: opt}
#  23: @construct.HyperRouter.24:[CNode]114{[0]: ValueNode<Primitive> getattr, [1]: [CNode]113, [2]: ValueNode<StringImm> reshape}
#  24: @construct.HyperRouter.24:[CNode]115{[0]: ValueNode<DoSignaturePrimitive> S-Prim-negative, [1]: ValueNode<Int64Imm> 1}
#  25: @construct.HyperRouter.24:weight{[0]: [CNode]114, [1]: [CNode]115, [2]: ValueNode<Int64Imm> 256, [3]: ValueNode<Int64Imm> 4}
#  26: @construct.HyperRouter.24:[CNode]119{[0]: ValueNode<Primitive> getattr, [1]: weight, [2]: ValueNode<StringImm> reshape}
#  27: @construct.HyperRouter.24:[CNode]120{[0]: ValueNode<DoSignaturePrimitive> S-Prim-negative, [1]: ValueNode<Int64Imm> 1}
#  28: @construct.HyperRouter.24:[CNode]121{[0]: ValueNode<DoSignaturePrimitive> S-Prim-mul, [1]: ValueNode<Int64Imm> 256, [2]: ValueNode<Int64Imm> 4}
#  29: @construct.HyperRouter.24:[CNode]122{[0]: [CNode]119, [1]: [CNode]120, [2]: [CNode]121}
#  30: @construct.HyperRouter.24:domain_cls_logits{[0]: ValueNode<FuncGraph> construct.MetaLinear.123, [1]: [CNode]122, [2]: opt}
#  31: @construct.HyperRouter.24:[CNode]117{[0]: ValueNode<FuncGraph> einsum.116, [1]: ValueNode<StringImm> bi,bil->bl, [2]: x, [3]: weight}
#  32: @construct.HyperRouter.24:x{[0]: ValueNode<FuncGraph> construct.Softmax.118, [1]: [CNode]117}
#  33: @construct.HyperRouter.24:[CNode]124{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MakeTuple, [1]: x, [2]: domain_cls_logits}
#  34: @construct.HyperRouter.24:[CNode]126{[0]: ValueNode<Primitive> Return, [1]: [CNode]124}


subgraph attr:
training : 0
subgraph instance: construct.MetaLinear.25 : 0x564db7d27c80
# In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:126/    def construct(self, inputs, opt = None, reserve = False):/
subgraph @construct.MetaLinear.25 parent: [subgraph @construct.Default.21](%para187_inputs, %para188_opt) {

#------------------------> 4
  %1([CNode]128) = call @L-construct.MetaLinear.127(%para187_inputs, %para188_opt, Bool(0), %para8_router1.fc1.weight)
      : (<Tensor[Float32], (8, 64)>, <None, NoShape>, <Bool, NoShape>, <Ref[Tensor[Float32]], (16, 256)>) -> (<null>)
      #scope: (Default)
  Return(%1)
      : (<null>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
}
# Order:
#   1: @construct.MetaLinear.25:[CNode]128{[0]: ValueNode<FuncGraph> L-construct.MetaLinear.127, [1]: inputs, [2]: opt, [3]: ValueNode<BoolImm> false, [4]: router1.fc1.weight}
#   2: @construct.MetaLinear.25:[CNode]129{[0]: ValueNode<Primitive> Return, [1]: [CNode]128}


subgraph attr:
training : 0
subgraph instance: L-construct.MetaLinear.26 : 0x564db7d94e60
# In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:126/    def construct(self, inputs, opt = None, reserve = False):/
subgraph @L-construct.MetaLinear.26(%para189_inputs, %para190_opt, %para191_reserve, %para192_) {
  %1([CNode]130) = S-Prim-not_equal(%para190_opt, None)
      : (<None, NoShape>, <None, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
  %2([CNode]132) = call @L-bool_.131(%1)
      : (<Bool, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
  %3([CNode]133) = Switch(%2, call @L-↰construct.MetaLinear.134, call @L-↱construct.MetaLinear.135)
      : (<Bool, NoShape>, <Func, NoShape>, <Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
  %4([CNode]136) = %3()
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
  %5([CNode]137) = call @L-bool_.131(%4)
      : (<Bool, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
  %6([CNode]138) = Switch(%5, call @L-✓construct.MetaLinear.139, call @L-✗construct.MetaLinear.27)
      : (<Bool, NoShape>, <Func, NoShape>, <Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/

#------------------------> 5
  %7([CNode]140) = %6()
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
  Return(%7)
      : (<null>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
}
# Order:
#   1: @L-construct.MetaLinear.26:[CNode]130{[0]: ValueNode<DoSignaturePrimitive> S-Prim-not_equal, [1]: opt, [2]: ValueNode<None> None}
#   2: @L-construct.MetaLinear.26:[CNode]132{[0]: ValueNode<FuncGraph> L-bool_.131, [1]: [CNode]130}
#   3: @L-construct.MetaLinear.26:[CNode]133{[0]: ValueNode<Primitive> Switch, [1]: [CNode]132, [2]: ValueNode<FuncGraph> L-↰construct.MetaLinear.134, [3]: ValueNode<FuncGraph> L-↱construct.MetaLinear.135}
#   4: @L-construct.MetaLinear.26:[CNode]136{[0]: [CNode]133}
#   5: @L-construct.MetaLinear.26:[CNode]137{[0]: ValueNode<FuncGraph> L-bool_.131, [1]: [CNode]136}
#   6: @L-construct.MetaLinear.26:[CNode]141{[0]: ValueNode<Primitive> resolve, [1]: ValueNode<NameSpace> ClassMember: 'Namespace:fastreid.modeling.ops..<MetaLinear::139889259347216>', [2]: ValueNode<Symbol> w_step_size}
#   7: @L-construct.MetaLinear.26:[CNode]142{[0]: ValueNode<Primitive> resolve, [1]: ValueNode<NameSpace> ClassMember: 'Namespace:fastreid.modeling.ops..<MetaLinear::139889259347216>', [2]: ValueNode<Symbol> b_step_size}
#   8: @L-construct.MetaLinear.26:[CNode]138{[0]: ValueNode<Primitive> Switch, [1]: [CNode]137, [2]: ValueNode<FuncGraph> L-✓construct.MetaLinear.139, [3]: ValueNode<FuncGraph> L-✗construct.MetaLinear.27}
#   9: @L-construct.MetaLinear.26:[CNode]140{[0]: [CNode]138}
#  10: @L-construct.MetaLinear.26:[CNode]129{[0]: ValueNode<Primitive> Return, [1]: [CNode]140}


subgraph attr:
training : 0
subgraph instance: L-✗construct.MetaLinear.27 : 0x564db7d8d620
# In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:127/        if opt != None and opt['meta']:/
subgraph @L-✗construct.MetaLinear.27 parent: [subgraph @L-construct.MetaLinear.26]() {

#------------------------> 6
  %1(output) = call @L-construct.Dense.28(%para189_inputs)
      : (<Tensor[Float32], (8, 64)>) -> (<null>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:145/            output = self.linear(inputs)/
  Return(%1)
      : (<null>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:146/            return output/
}
# Order:
#   1: @L-✗construct.MetaLinear.27:output{[0]: ValueNode<FuncGraph> L-construct.Dense.28, [1]: inputs}
#   2: @L-✗construct.MetaLinear.27:[CNode]143{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
training : 0
subgraph instance: L-construct.Dense.28 : 0x564db7da0b70
# In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:590/    def construct(self, x):/
subgraph @L-construct.Dense.28 parent: [subgraph @L-construct.MetaLinear.26](%para193_x) {

#------------------------> 7
  %1([CNode]144) = call @L-L-construct.Dense.29(%para193_x, %para192_L-router1.fc1.weight)
      : (<Tensor[Float32], (8, 64)>, <Ref[Tensor[Float32]], (16, 256)>) -> (<null>)
      #scope: (Default)
  Return(%1)
      : (<null>)
      #scope: (Default/router1-HyperRouter/fc1-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/
}
# Order:
#   1: @L-construct.Dense.28:[CNode]144{[0]: ValueNode<FuncGraph> L-L-construct.Dense.29, [1]: x, [2]: L-router1.fc1.weight}
#   2: @L-construct.Dense.28:[CNode]145{[0]: ValueNode<Primitive> Return, [1]: [CNode]144}


subgraph attr:
training : 0
subgraph instance: L-L-construct.Dense.29 : 0x564db7dadcf0
# In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:590/    def construct(self, x):/
subgraph @L-L-construct.Dense.29(%para194_x, %para195_) {
  %1(фx_shape) = S-Prim-Shape(%para194_x)
      : (<Tensor[Float32], (8, 64)>) -> (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:600/        if len(x_shape) != 2:/
  %2([CNode]146) = S-Prim-check_dense_input_shape[constexpr_prim=Bool(1)](%1, "Dense")
      : (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>, <String, NoShape>) -> (<None, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:592/        check_dense_input_shape(x_shape, self.cls_name)/
  %3([CNode]147) = StopGradient(%2)
      : (<None, NoShape>) -> (<None, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:145/            output = self.linear(inputs)/
  %4([CNode]149) = call @L-L-ms_len.148(%1)
      : (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>) -> (<Int64, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/
  %5([CNode]150) = S-Prim-not_equal(%4, I64(2))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/
  %6([CNode]152) = call @L-L-bool_.151(%5)
      : (<Bool, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/
  %7([CNode]153) = Switch(%6, call @L-L-✓construct.Dense.154, call @L-L-✗construct.Dense.155)
      : (<Bool, NoShape>, <Func, NoShape>, <Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/
  %8([CNode]156) = %7()
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/

#------------------------> 8
  %9([CNode]157) = call @L-L-↓construct.Dense.30(%8)
      : (<Tensor[Float32], (8, 64)>) -> (<null>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:145/            output = self.linear(inputs)/
  %10([CNode]158) = Depend[side_effect_propagate=I64(1)](%9, %3)
      : (<null>, <None, NoShape>) -> (<null>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:145/            output = self.linear(inputs)/
  Return(%10)
      : (<null>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/
}
# Order:
#   1: @L-L-construct.Dense.29:фx_shape{[0]: ValueNode<DoSignaturePrimitive> S-Prim-Shape, [1]: x}
#   2: @L-L-construct.Dense.29:[CNode]146{[0]: ValueNode<DoSignaturePrimitive> S-Prim-check_dense_input_shape, [1]: фx_shape, [2]: ValueNode<StringImm> Dense}
#   3: @L-L-construct.Dense.29:[CNode]149{[0]: ValueNode<FuncGraph> L-L-ms_len.148, [1]: фx_shape}
#   4: @L-L-construct.Dense.29:[CNode]150{[0]: ValueNode<DoSignaturePrimitive> S-Prim-not_equal, [1]: [CNode]149, [2]: ValueNode<Int64Imm> 2}
#   5: @L-L-construct.Dense.29:[CNode]152{[0]: ValueNode<FuncGraph> L-L-bool_.151, [1]: [CNode]150}
#   6: @L-L-construct.Dense.29:[CNode]153{[0]: ValueNode<Primitive> Switch, [1]: [CNode]152, [2]: ValueNode<FuncGraph> L-L-✓construct.Dense.154, [3]: ValueNode<FuncGraph> L-L-✗construct.Dense.155}
#   7: @L-L-construct.Dense.29:[CNode]156{[0]: [CNode]153}
#   8: @L-L-construct.Dense.29:фself.bias_add{[0]: ValueNode<Primitive> resolve, [1]: ValueNode<NameSpace> ClassMember: 'Namespace:mindspore.nn.layer.basic..<Dense::139889259398944>', [2]: ValueNode<Symbol> bias_add}
#   9: @L-L-construct.Dense.29:[CNode]157{[0]: ValueNode<FuncGraph> L-L-↓construct.Dense.30, [1]: [CNode]156}
#  10: @L-L-construct.Dense.29:[CNode]158{[0]: ValueNode<Primitive> Depend, [1]: [CNode]157, [2]: [CNode]147}
#  11: @L-L-construct.Dense.29:[CNode]159{[0]: ValueNode<Primitive> Return, [1]: [CNode]158}


subgraph attr:
after_block : 1
training : 0
subgraph instance: L-L-↓construct.Dense.30 : 0x564db7e231d0
# In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:593/        if len(x_shape) != 2:/
subgraph @L-L-↓construct.Dense.30 parent: [subgraph @L-L-construct.Dense.29](%para196_) {
  %1([CNode]160) = call @L-L-bool_.151(Bool(0))
      : (<Bool, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:596/        if self.has_bias:/
  %2([CNode]161) = Switch(%1, call @L-L-✓↓construct.Dense.162, call @L-L-✗↓construct.Dense.31)
      : (<Bool, NoShape>, <Func, NoShape>, <Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:596/        if self.has_bias:/

#------------------------> 9
  %3([CNode]163) = %2()
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:596/        if self.has_bias:/
  %4([CNode]165) = call @L-L-↓↓construct.Dense.164(%3)
      : (<null>) -> (<null>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear)
      # In file /home/yuming/ACL-DGReID-mindspore/fastreid/modeling/ops.py:145/            output = self.linear(inputs)/
  Return(%4)
      : (<null>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:596/        if self.has_bias:/
}
# Order:
#   1: @L-L-↓construct.Dense.30:x{[0]: ValueNode<DoSignaturePrimitive> S-Prim-MatMul, [1]: фx, [2]: L-router1.fc_classifier.weight}
#   2: @L-L-↓construct.Dense.30:[CNode]160{[0]: ValueNode<FuncGraph> L-L-bool_.151, [1]: ValueNode<BoolImm> false}
#   3: @L-L-↓construct.Dense.30:[CNode]161{[0]: ValueNode<Primitive> Switch, [1]: [CNode]160, [2]: ValueNode<FuncGraph> L-L-✓↓construct.Dense.162, [3]: ValueNode<FuncGraph> L-L-✗↓construct.Dense.31}
#   4: @L-L-↓construct.Dense.30:[CNode]163{[0]: [CNode]161}
#   5: @L-L-↓construct.Dense.30:[CNode]165{[0]: ValueNode<FuncGraph> L-L-↓↓construct.Dense.164, [1]: [CNode]163}
#   6: @L-L-↓construct.Dense.30:[CNode]166{[0]: ValueNode<Primitive> Return, [1]: [CNode]165}


subgraph attr:
training : 0
subgraph instance: L-L-✗↓construct.Dense.31 : 0x564db7e20fd0
# In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:596/        if self.has_bias:/
subgraph @L-L-✗↓construct.Dense.31 parent: [subgraph @L-L-↓construct.Dense.30]() {

#------------------------> 10
  %1(x) = $(L-L-↓construct.Dense.30):S-Prim-MatMul[output_names=["output"], transpose_a=Bool(0), input_names=["x1", "x2"], transpose_x2=Bool(1), transpose_x1=Bool(0), transpose_b=Bool(1)](%para196_фx, %para195_L-router1.fc_classifier.weight)
      : (<Tensor[Float32], (8, 64)>, <Ref[Tensor[Float32]], (16, 256)>) -> (<null>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:595/        x = self.matmul(x, self.weight)/
  Return(%1)
      : (<null>)
      #scope: (Default/router1-HyperRouter/fc_classifier-MetaLinear/linear-Dense)
      # In file /home/yuming/miniconda3/envs/reid/lib/python3.9/site-packages/mindspore/nn/layer/basic.py:596/        if self.has_bias:/
}
# Order:
#   1: @L-L-✗↓construct.Dense.31:[CNode]167{[0]: ValueNode<Primitive> Return, [1]: x}


#===============================================================================
# num of function graphs in stack: 11/12 (Ignored 1 internal frames).
